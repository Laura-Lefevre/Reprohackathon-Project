#!/bin/bash
rule download_gtf:
    output:
        "SRR_annotated_gene.gtf"
    shell:
        """
        echo "Downloading GTF annotation file..."
        wget -O {output}.gz ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/013/425/GCF_000013425.1_ASM1342v1/GCF_000013425.1_ASM1342v1_genomic.gtf.gz

        echo "Decompressing GTF file..."
       
        gunzip -f {output}.gz
        
        echo "GTF file downloaded and decompressed."
        """
    # Last motification of GCF_000013425.1_ASM1342v1_genomic.gtf.gz: 2025-03-31



rule featureCounts:
    input: 
        bam= expand("sample/{{sample}}.bam", sample=SAMPLES)
        gtf = "ref/*.gtf"

    Output:
        counts="output/featureCounts/{sample}_counts.txt"
    threads: 4
    #container:  a complete/path/to/container.sif
    shell:
        """
        echo "Running featureCounts"

        featureCounts -t gene -g ID -s 1\
        -a {input.gtf} \
        -o {output.counts} \
        {input.bam}

        echo "featureCounts completed"
        """
