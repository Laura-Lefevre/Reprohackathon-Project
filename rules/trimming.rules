######################################################
### Reprohackathon Project - 2025
### Author : Camille LE CORRE
### Description : rule trimming
######################################################

rule trimming:
    input:
        fastq = "output/fastq/{srr}.fastq"
    output:
        trimmed_fastq = "output/trimmed/{srr}_trimmed.fq"
    log:
        "logs/trimming/{srr}.log"
    threads: THREADS
    container:
        f"{ZENODO_URL}{SIF_LIST[3]}"
    params:
        outdir = "output/trimmed",
        quality = config["QUALITY"],
        phred   = config["PHRED"],
        minlen  = config["MINLEN"]
    shell:
        """
        echo "Trimming {input.fastq} with cutadapt..." > {log} 2>&1
    
        cutadapt \
            -m {params.minlen} \
            -q {params.quality} \
            -o {output.trimmed_fastq} \
            {input.fastq} \
            >> {log} 2>&1
    
        echo "Trimming complete for {wildcards.srr}" >> {log} 2>&1
        """
