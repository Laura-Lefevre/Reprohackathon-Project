# Differential expression with DESeq2
########################################
# RULE: DESeq2
########################################

COUNTS  = "output/counts/all_samples_counts.txt"
SAMPLES = "samples.tsv"
OUTDIR  = "results/deseq2"

rule deseq2:
    input:
        counts  = COUNTS,
        samples = SAMPLES
    output:
        resdf = f"{OUTDIR}/res_df.csv",
        deg   = f"{OUTDIR}/deg.csv",
        up    = f"{OUTDIR}/deg_up.csv",
        down  = f"{OUTDIR}/deg_down.csv",
        vsd   = "results/vsd.rds"
    params:
        outdir = OUTDIR,
        vsd    = "results/vsd.rds"
    container:
        f"{ZENODO_URL}{SIF_LIST[5]}"
    shell:
        """
        mkdir -p {params.outdir}
        Rscript deseq2.R \
            {input.counts} \
            {input.samples} \
            {params.outdir} \
            {params.vsd}
        """

