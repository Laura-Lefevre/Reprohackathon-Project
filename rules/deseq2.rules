# Differential expression with DESeq2
########################################
# RULE: DESeq2
########################################

COUNTS  = "output/counts/all_samples_counts.txt"
SAMPLES = "metadata/samples.tsv"
OUTDIR  = "output/deseq2"

rule deseq2:
    input:
        counts  = COUNTS,
        samples = SAMPLES
    output:
        resdf = f"{OUTDIR}/res_df.csv",
        deg   = f"{OUTDIR}/deg.csv",
        up    = f"{OUTDIR}/deg_up.csv",
        down  = f"{OUTDIR}/deg_down.csv",
        vsd   = "output/vsd.rds"
    params:
        outdir = OUTDIR,
        vsd    = "output/vsd.rds"
    container:
        f"{ZENODO_URL}{SIF_LIST[4]}"
    shell:
        """
        mkdir -p {params.outdir}
        Rscript scripts/deseq2.R \
            --counts {input.counts} \
            --samples {input.samples} \
            --outdir {params.outdir} \
            --vsd {params.vsd}

        """

