rule downloading_fastq:
    output:
        "output/fastq/{srr}.fastq"
    threads: THREADS
    container:
        f"{ZENODO_URL}{SIF_LIST[0]}"
    shell:
        """
        echo "Downloading {wildcards.srr}..."

        if [ -f output/fastq/{wildcards.srr}.fastq ]; then
            rm output/fastq/{wildcards.srr}.fastq
        fi

        fasterq-dump --threads {threads}  --progress --outdir output/fastq {wildcards.srr}

        TMPDIR=$(find output/fastq -maxdepth 1 -type d -name "fasterq.tmp.*" | head -n 1)
        if [ -n "$TMPDIR" ]; then
            rm -rf "$TMPDIR"
        fi

        echo "Download complete for {wildcards.srr}"
        """