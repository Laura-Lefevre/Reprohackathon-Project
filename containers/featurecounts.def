Bootstrap: docker
From: ubuntu:22.04

%labels
    Author "Muyao GUO"
    Description "Singularity container for featureCounts (subread)"

%post
    apt-get update && \
    apt-get install -y wget ca-certificates tar && \
    cd /opt && \
    # Downloads Subread 1.4.6-p3 
    wget -q https://downloads.sourceforge.net/project/subread/subread-1.4.6-p3/subread-1.4.6-p3-Linux-x86_64.tar.gz &&\
    tar -xzf subread-1.4.6-p3-Linux-x86_64.tar.gz && \
    ln -s /opt/subread-1.4.6-p3-Linux-x86_64/bin/featureCounts /usr/local/bin/featureCounts && \
    chmod +x /usr/local/bin/featureCounts && \
    apt-get clean && rm -rf /var/lib/apt/lists/*

%environment
    export PATH=/usr/local/bin:$PATH
    export LC_ALL=C
    export LANG=C

%runscript
    exec featureCounts "$@"

%help
    This container provides featureCounts from Subread version 1.4.6-p3.
    Example:
        singularity exec counting.sif featureCounts -a genes.gtf -o counts.txt sample.bam
        singularity run counting.sif -a genes.gtf -o counts.txt sample.bam
